@inject YourIngredients YourIngredients
@inject FilterData FilterData
@inject NavigationManager NavigationManager
@inject IJSRuntime jsRuntime

<button class="btn btn-outline-primary my-2 my-sm-0" type="submit" onclick=@NavigateToURL>
    <svg xmlns="http://www.w3.org/2000/svg"
         width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
         stroke-linecap="round" stroke-linejoin="round"
         class="mx-3">
        <circle cx="10.5" cy="10.5" r="8"></circle>
        <line x1="21" y1="25" x2="15.8" y2="18.8"></line>
    </svg>
</button>

@code {
    [Parameter]
    public string? CurrentValue { get; set; }
    [Parameter]
    public SearchModeEnum searchMode { get; set; }

    private SearchService searchService;

    protected override void OnInitialized()
    {
        searchService = new SearchService(FilterData);
    }

    private void NavigateToURL()
    {
        if ((CurrentValue != null && CurrentValue.Length > 0) ||
            YourIngredients.list.Count > 0)
        {
            List<int> recipeIDs = new List<int>();
            if (searchMode == SearchModeEnum.ByRecipe)
            {
                recipeIDs = searchService.GetRecipeResults(CurrentValue);
            }
            else 
            { 
                recipeIDs = searchService.GetRecipeResults(YourIngredients.list);
            }

            NavigationManager.NavigateTo(constructURL(recipeIDs));
        }
    }

    private string constructURL(List<int> recipeIDs)
    {
        string url = "/SearchPage?ids=";
        foreach (var id in recipeIDs)
        {
            if (id == recipeIDs[0])
            {
                url += id;
            }
            else
            {
                url += "," + id;
            }
        }
        Console.WriteLine(url);
        return url;
    }
}